# 💎 鉱石採掘ゲームプラグイン　for Minecraft 

Minecraftサーバ上で動作する、約2分間のスコアアタック型ミニゲーム「鉱石採掘ゲーム」を実装した Spigot/Paperプラグインです。
プレイヤーはピッケルと松明を手に採掘場へテレポートし周囲にランダムで出現する鉱石を破壊して高得点を目指しましょう！
コンボボーナスを狙えばさらにスコアアップ！　スコアはデータベースに記録され、リーダーボード形式で一覧可能です。
スコアや難易度設定に応じたバランス調整・データベース連携機能も搭載し、実用性と拡張性を意識した構成になっています。

-----

## ⚠️注意事項・ユーザー向けガイド 
このゲームはサーバー上でミニゲームとして楽しめるよう設計されていますが、通常のMinecraftプレイとは異なる挙動があるため、以下の点にご注意ください。

### ❌ゲームの中断・再開について
- ゲーム開始後に途中でログアウトしても中断処理は行われません。
 - 内部的にはゲーム継続中となりますが、再ログイン後にスコアボードが表示されなくなったり、終了メッセージ・テレポートなどの処理が正しく実行されないことがあります。
 - このため、**ログアウト前提でのプレイ**は非推奨です。
 - ※今後「中断時は即ゲーム終了」「コマンドでゲーム終了」といった対応を実装予定です。
   
### 💎鉱石のドロップについて
- どの難易度・どのゲームモード(例:サバイバル)でプレイしても鉱石を破壊してもアイテムはドロップしません。
 - 鉱石はスコア加算用であり、通常のアイテム取得とは完全に切り離されています。

### 🧗ゲームフィールドについて
- フィールド上の一部ブロックは鉱石出現によって一時的に置き換えられます。
 - ゲーム終了時には元通り復元されますが、建物や構造物内でのプレイは避けることを推奨します。
 - ブロック破壊に関しては保護されていますが、完全な衝突防止ではないため周囲に注意してください。
 - フィールドのブロックが復元されるタイミングでは、**埋まり込みやダメージを防ぐため**、強制的にゲーム開始地点へテレポートされる仕様になっています。
 
----

## 🎮 ゲームの流れ *
1. '/treasurehunter [難易度]' を実行すると、採掘場にテレポートしダイヤモンドのピッケルと松明が配布され、体力と空腹度は最大化されます
2. 制限時間(例 : easy = 100秒 , normal = 80秒 , hard = 60秒 )内に、出現する鉱石を採掘してください。
3. 鉱石を連続して採掘すると **コンボボーナス** が加算され、戦略的なゲームが可能になります。
4. ゲーム終了後はスコアが表示され、元の持ち物・位置に戻されます。
5. 成績は自動的にデータベースに保存され、'/treasurehunter list' で確認可能。

----

## * プレイ動画 *


[プレイ動画1.mp4](../../../OneDrive/%E3%83%87%E3%82%B9%E3%82%AF%E3%83%88%E3%83%83%E3%83%97/%E3%83%97%E3%83%AC%E3%82%A4%E5%8B%95%E7%94%BB1.mp4)

----

# * 💡こだわり・工夫したポイント 

**ブロック復元システム**
- 鉱石で置き換えたブロックの元のBlockStateを保存し、終了時にフィールドの完全復元ができるように意識しました。
- 建築物や、地形を破壊しても気にすることなくゲームが楽しめる点が利点。

**コンボシステムによるゲーム性の強化**
- 同じ種類の鉱石を連続して破壊することで、スコアにボーナスが加算されます。
- プレイヤーの「次はどの鉱石を掘るか」という戦略性を誘えるように意識しました。

**難易度設定の拡張性**
- 難易度別に鉱石の種類、出現率、制限時間を切り替え可能にしました。
- GameDifficultyクラスを拡張することで新しい難易度の追加もスムーズにできるように意識しました。

**テレポートシステムでプレイをスムーズに**
- ゲーム開始時 : プレイヤーを自動で専用エリアに転送
- ゲーム終了時 : 元のワールド、座標に復元(任意
  - 終了直後はゲーム開始時の座標に戻ることで復元ブロックとの干渉によるダメージを回避できます。
  - /backコマンドで任意のタイミングでコマンド入力位置に帰還可能

**スコアボードの表示で没入感を演出**
- ActionBarに残り時間とスコアを常時表示し、プレイヤーが進行状況を分かりやすいように。

**プレイヤーへの配慮**
- 装備・アイテムの復元処理
  - ゲーム開始時にインベントリをバックアップし、終了後に元通りに復元できるようにしました。
- 元の位置への復帰処理
    - originalLocationを記録し、終了後にスムーズに元の座標へ戻す。
- 復元による事故の回避
    - ブロックが復元されて埋まってしまう状況を防止。
----

## 🚧 今後実装予定の機能 
- スコアランキング表示機能
- 特殊アイテムの導入(スコア倍増、制限時間延長)
- 特殊イベント or 妨害イベント
- ゲーム中の中断処理、コマンドで即終了機能
- Docker対応による環境構築の自動化

-----



## 💡 使用コマンド *
コマンド                            | 説明                                      
-----------------------------------|--------------------------------------------------------------
| '/treasurehunter [難易度]'    　　| ゲームを開始します ( 難易度 : easy / normal / hard)
| '/treasurehunter list'  　　　　 | プレイヤーの過去のスコア履歴を表示
| '/back' 　　　      　　　　　　　 | ゲーム終了後に元の位置へ戻る(任意)

-----

## * 鉱石ポイント一覧 *
・鉄鉱石(IRON_ORE)    1P

・金鉱石(GOLD_ORE)    10P

・ラピスラズリ、レッドストーン鉱石(LAPIS_ORE,REDSTONE_ORE) 20P

・ダイアモンド鉱石(DIAMOND_ORE)      50P

・エメラルド鉱石(EMERALD_ORE)        80P

----

## ⚙️ 機能概要 *
- '/treasurehunter [難易度]' でゲーム開始 ( 難易度 : easy / normal / hard )
- 制限時間は難易度ごとに異なり、採掘できる鉱石の種類も変化します。
- コンボボーナス機能でスコア加算に戦略性を持たせました。
- '/back' コマンドで元の場所に戻ることが可能です。
- ゲーム終了後にコマンド入力で元の位置と装備に復元できます。
- プレイヤーごとのスコア履歴をMySQLデータベースに記録

-----
## * 開発環境 *

- Minecraft : v1.21.4
- Java      : v23
- Server    : paper 1.21.4

----


## 🗄️ データベース連携について *
このプラグインではゲーム終了時のプレイヤーのスコア情報を**MySQLデータベース**に保存しています。
記録されたデータはランキング機能などに活用できます。

----

## * データベース設計 *

  テーブル名 : player_score
  
属性                            | 設定値                                      
-----------------------------------|--------------------------------------------------------------
| ユーザー名   　　| 　※
| パスワード　　 | 　※
| URL　 | 　※　　　
| データベース名　| treasure_game 
| テーブル名　　| player_score


(※) はご自身のMySQL環境に合わせて設定してください。

-----

## * データベース構成 *

  
カラム名                           | 　説明                                     
-----------------------------------|--------------------------------------------------------------
| id   　　| 主キー、AUTO_INCREMENT
| player_name　　 | プレイヤー名
| score　 | ゲームで獲得したスコア　　
| difficulty　| プレイした難易度 
| registered_at　　| 登録日時

----

## * データベースの接続方法 *
1. 自身のローカル環境でMySQLに接続してください。
2. 以下のSQLコマンドを実行してください。

```sql
CREATE DATABASE treasure_game;
```

```sql
USE treasure_game;
```

```sql
CREATE TABLE player_score(id INT AUTO_INCREMENT , player_name VARCHAR(100), score INT, difficulty VARCHAR(30), registered_at datetime, PRIMARY KEY(id)) DEFAULT CHARSET=utf8;
```

-----


### * おわりに *
このプロジェクトは「ミニゲームとしての楽しさ」と「オブジェクト指向による設計の柔軟性」の両立を意識して開発しました。
スコアボード・コンボ・難易度設定といった要素に加え、プレイヤーの状態復元やブロック復元処理など、没入感と安全性を重視した工夫も多く取り入れています。
現時点では未対応機能もありますが、今後のアップデートでより快適かつ楽しいゲームへアップデートできるよう改善を続けていく予定です。

##  📬ご意見・フィードバック
もし、バグ報告や改善提案がありましたら、ぜひお気軽にお知らせください！
(GitHub Issue や Pull Request 等)

今後も改善を続けていきますので、よろしくお願いいたします！

---






